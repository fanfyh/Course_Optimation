---
subtitle: "第八讲 不确定性"
editor: visual
---

## 期望效用

- 假定存在一系列不同状态的基本事件(events)$i = 1, 2, \cdots, m$；

- 记第$i$个基本事件发生的概率为$p_i$，这些概率非负且和为一；

- 与经济事件相关的实现结果通常是收入水平、财富或者决策者应得的利润$Y_i$，这些结果所带来的效用分别为$U(Y_i)$；

- 定义**期望效用函数**（冯·诺依曼-摩根斯坦效用）为：

$$
\sum_{i = 1}^m p_iU(Y_i)
$$

## 风险规避

定义决策者是风险规避的，如果对于若干个事件$Y_1, Y_2, \cdots, Y_m$，有

$$
U(\sum_{i = 1}^m p_i Y_i) > \sum_{i = 1}^m p_i U(Y_i)
$$

- 左边是**期望收益的效用**，右边是事件的**期望效用**；

- U在所有事件组成的集合中是（严格）凹的，换言之如果$U$是二次可微的，则$U^{''} <0$意味着风险规避。

## 最优保费问题 I

假设存在两个事件，其收益和发生概率分别为$Y_1, Y_2$和$p_1, p_2$，且$Y_1 < Y_2$。为了规避风险，决策者可以预付保费$x$，并在事件1发生时赔付$X = x/p$，在事件2发生时不赔付。
购买保险后的期望效用为：

$$
pU(Y_1 - x + x/p) + (1 - p)U(Y_2 - x)
$$

用链式法则可以找到$x$为最优解的一阶条件

$$
pU^{'}(Y_1 - x + x/p) (1/p - 1) = (1 - p)U^{'}(Y_2 - x)
$$

如果$U^{''} < 0$(风险规避者)，上述条件也是充分的，并且意味着

$$
Y_1 - x + x/p = Y_2 - x
$$

因此，最优保费为$x = p(Y_2 - Y_1)$，即一个风险规避的决策者会购买保险，使得各个不同状态下的收益相等。

## 最优保费问题 II

假设保险不仅影响事件的收益，同时会影响事件的发生概率，即决策者可以通过一个预算的支出$z$降低坏结果1的概率（但不进行赔付）。例如，使用一个更可靠但更昂贵的产品，或者在有风险的活动中更加谨慎小心，而这种小心翼翼会带来负效用。

则目标函数变为

$$
O(z) \equiv p(z)U(Y_1 - z) + [1 - p(z)]U(Y_2 - z)
$$

其中$p(z)$是关于$z$的递减函数。意味着随着保费的增加，坏结果1发生的概率会降低。

## 最优保费问题 III

此时对期望收益$O(z)$求导可得

$$
\begin{aligned}
    O^{'}(z) & = - p^{'}(z)[U(Y_2 - z) - U(Y_1 - z)] \\
    & - \{p(z)U^{'}(Y_1 - z) + [1 - p(z)]U^{'}(Y_2 - z)\}
\end{aligned}
$$

- 第一项代表着谨慎行为或使用高质量产品的期望边际收益，是坏结果概率的边际减少乘以两种结果的效用差；

- 第二项是谨慎行为或使用高质量产品的期望边际成本。

## 最优保费问题 IV

假设保险和谨慎行为都存在，保险公司不能辨别人们是否谨慎行事，而只能观察到结果。如果存在保险经算上公平的保险，目标函数为

$$
O(x, z) \equiv p(z)U(Y_1 - z - x + x/p(z)) + [1 - p(z)]U(Y_2 - z - x)
$$

关于$x$的一阶条件为

$$
Y_1 - z - x + x/p(z) = Y_2 - z - x
$$

## 最优保费问题 V

关于$z$的一阶条件为

$$
\begin{aligned}
    O_z(x, z) & = - p^{'}(z) [U(Y_2 - z - x) - U(Y_1 - z - x + x/p(z))] \\
    & - \{
    p(z)U^{'}(Y_1 - z - x + x/p(z)) \\
    & + [1 - p(z)]U^{'}(Y_2 - z - x)\}
\end{aligned}
$$

记$Y_0$为满足$x$一阶条件的值，则上述条件可以表示为

$$
\begin{aligned}
    O_z(x, z) & = - p^{'}[U(Y_0) - U(Y_0)] - U^{'}(Y_0) \\
    & = - U^{'}(Y_0) < 0
\end{aligned}
$$

当存在完全保险时，谨慎行为所获得的边际收益消失了，但边际成本仍然为正。因而谨慎行为的最优值位于角点$z = 0$处，即存在**道德风险**问题。

## 连续变量下的不确定性问题

假设存在一个事件连续统$[\underline{r}, \overline{r}]$，随机变量$r$代表事件，概率密度函数为$f(r)$。期望效用函数为

$$
E[U(Y)] = \int_{\underline{r}}^{\underline{r}}U(Y(r))f(r)dr
$$

类似地，$Y$的期望收益为

$$
E[Y] = \int_{\underline{r}}^{\underline{r}}Y(r)f(r)dr
$$

因此$U^{''} < 0$意味着

$$
U[E(Y)] > E[U(Y)]
$$

## 风险资产和无风险资产 I

一个投资者拥有初始财富$W_0$。投资于风险资产$x$产生总收益（本金加利息）$x(1 + r)$，其中$r$为一个随机变量，其密度函数为$f(x)$；无风险资产则支付零利息。最终的（随机）财富为

$$
W = (W_0 - x) + x(1 + r) = W_0 + xr, x \in [0, W_0]
$$

投资者有严格凹的冯·诺依曼-摩根斯坦函数$U$，选择$x$以最大化

$$
E[U(W)] = \int_{\underline{r}}^{\overline{r}}U(W_0 + xr)f(r)dr
$$

## 风险资产和无风险资产 II

因此，投资者的最优决策应满足

$$
O^{'}(x) = \int_{\underline{r}}^{\overline{r}}rU^{'}(W_0 + xr)f(r)dr = 0
$$

特别地

$$
O^{'}(0) = U^{'}(W_0)\int_{\underline{r}}^{\overline{r}}rf(r)dr = U^{'}(W_0)E[r]
$$

如果风险资产利率的数学期望是正的($E[r] > 0$)，则$O^{'}(0)$必为正。那么，$x$的最优值就不可能为零。

## 风险资产和无风险资产 III

如果$\underline{r} > 0$，那么对于所有的$x$，都有$O^{'}(x) > 0$， 而且将所有的$W_0$投资于风险资产是最优的。关于$x$的一阶条件是

$$
\int_{\underline{r}}^{\overline{r}}rU^{'}(W_0 + xr)f(r)dr = 0
$$

如果存在一个满足上述条件的$x < W_0$，则$U$的凹姓保证了它是全局最优值。

## 比较静态分析 I

假定初始财富$W_0$是可变的，将最大值函数写为$O(x, W_0)$，对其全微分可得

$$
dx/dW_0 = - O_{xw}(x, W_0)/O_{xx}(w, W_0)
$$

由二阶条件可知，上式分母为负，因此$dx/dW_0$的符号取决于二阶交叉导数的符号。而分子

$$
O_{xw}(x, W_0) = \int_{\underline{r}}^{\overline{r}}rU^{''}(W_0 + xr)fr(r)dr
$$

当且仅当$\underline{r} < 0 < \overline{r}$时，才存在一个可能的最优内点解$x$。

## 风险规避系数

定义一个冯·诺依曼-摩根斯坦效用函数的**绝对风险规避系数**为

$$
A(W) = - U^{''}(W)/U^{'}(W)
$$

- 如果$A(W) < 0$，意味着决策者是风险厌恶的；反之则是风险偏好的；

- 当$|A(w)|$越大时，意味着决策者的风险厌恶/偏好程度越大；

- 较为富有的投资者更能容忍给定的边际风险，因此预期$A(W)$应该是递减函数。

## 比较静态分析 II

如果绝对风险规避系数$A(W)$是财富的递减函数，那么富有的投资者将持有更有的风险资源。注意到，如果$r < 0$，则

$$
- U^{''}(W_0 + xr)/U^{'}(W_0 + xr) >  - U^{''}(W0)/U^{'}(W0) = A(W0)
$$

两边乘以$-r$有

$$
 rU^{''}(W0 + xr)/U^{'}(W0 + xr) >  -r A(W0)
$$

即

$$
rU^{''}(W0 + xr) > -A(W0)rU^{'}(W0 + xr)
$$

## 比较静态分析 III

类似地，对$r >0$同样有

$$
rU^{''}(W0 + xr) > -A(W0)rU^{'}(W0 + xr)
$$

因此，对任意区间的$r$积分有

$$
\int_{\underline{r}}^{\overline{r}}rU^{''}(W0 + xr) f(r) dr > - A(W0)\int_{\underline{r}}^{\overline{r}}rU^{'}(W0 + xr)f(r)dr = 0
$$

这意味着，$dx/dW0 >0$。换言之，随着初始财富$W0$的增加，最优风险资产持有$x$会上升。

## 投资组合选择 I

假设投资者的目标函数可以表示成财富的均值$M$和标准差$S$的一个函数，在期望效用函数框架中，这对应着两种特殊情况

如果冯·诺依曼-摩根斯坦效用函数是二次的
$$
U(W) = W - \frac{1}{2}aW^2, a > 0
$$

那么
$$
E[U(W)] = M - \frac{1}{2}a(M^2 + S^2)
$$

## 投资组合选择 II

- 如果每一种资产都有正态分布的回报，那么财富也是正态分布的。并且任何冯·诺依曼-摩根斯坦效用函数都可以用均值和方差来表示。例如
$$
U(W) = - exp(-aW), a >0
$$

- 其期望为
$$
E[U(W)] = - exp(- a[M - \frac{1}{2}aS^2])
$$

- 当$(M - \frac{1}{2}aS^2)$达到最大值时，期望效用也达到最大。同时，对于这个函数而言，绝对风险规避系数为常数，并且等于$a$。

## 投资组合选择 III

- 假设初始财富始终不变，且标准化为1；

- 存在$n$种资产，且总收益可以写作$r = (r_1, r_2, \cdots, r_n)$，其数学期望为$\mu = (\mu_1, \mu_2, \cdots, \mu_n)$;

- 总收益的方差-协方差矩阵为$\sum = (\sigma_{ij})$；

- 投资组合即为投资于各种不同资产的财富比例向量$x = (x_1, x_2, \cdots, x_n)$

投资组合选择问题本质上是要构建$M$和$S$之间的**可行转换边界**。

## 投资组合选择 IV

因此，随机的最终财富为

$$
W = \sum_{i = 1}^n x_i r_i = x^{T}r
$$

最终财富的均值和方差分别为

$$
\begin{aligned}
    M & = \sum_{i =1}^n x_i \mu_i = x^{T}\mu \\
    S^2 & = \sum_{i = 1}^n \sum_{j = 1}^n x_i x_j \sigma_{ij} = x^{T}\sum x
\end{aligned}
$$

注意$M$和$S^2$都是$x$的函数。

## 可行转化边界 I

为了找到$M$和$S$之间的可行转换边界，对于给定的均值要最小化标准差，即

$$
\begin{aligned}
    min\quad & S = (x^{T}\sum x)^{1/2} \\
    s.t.\quad & x^{T}\mu = M, x^{T} e = 1
\end{aligned}
$$

在两种资产的情况下，令$x$代表$x_1$，那么$x_2 = 1 - x$。因而

$$
M = \mu_2 + (\mu_1 - \mu_2)x
$$

且

$$
S^2 = \sigma_2^2 - 2K_{2}x +(K_1 + K_2) x^2
$$

其中

$$
K_1 \equiv \sigma_1^2 - \rho \sigma_1 \sigma_2, K_2 \equiv \sigma_1^2 - \rho \sigma_1 \sigma_2
$$

## 可行转化边界 II

将资产排序确保$\mu_1 > \mu_2$。当$x$从0增加到1，$M$从$\mu_2$增加到$\mu_1$，且$S$从$\sigma_2$变到$\sigma_1$时，沿此方向有

$$
SdS/dx = - K_2 + (K_1 + K_2)x
$$

因此，在$x = 0$处

$$
dS/dx = -  (\sigma_2 - \rho \sigma_1)
$$

以及在$x = 1$处

$$
dS/dx = \sigma_1 - \rho \sigma_2
$$

## 可行转化边界 III

- 如果$\sigma_1 > \sigma_2$，那么在两个完全专门化的投资组合之间，存在风险-收益的权衡。因此在$x = 1$附近$dS/dx$肯定为正。

- 即使$\sigma_1 < \sigma_2$，即资产1完全优于资产2，只要$\rho$足够小，也可能通过混合两种资产而得到分散化的收益，从而也存在一个权衡。

- 更一般地，方差最小的投资组合由下式给出
$$
x = \frac{K_1}{K_1 + K_2} = \frac{\sigma_2^2 - \rho \sigma_1 \sigma_2}{(\sigma_1^2 - \rho \sigma_1 \sigma_2) + (\sigma_2^2 - \rho \sigma_1 \sigma_2)}
$$

- 从上式看，$x \in [0,1]$，即不存在任何卖空行为。

## 可行转化边界 IV

对
$
SdS/dx = - K_2 + (K_1 + K_2)x
$
两边同时再次微分

$$
\begin{aligned}
    K_1 + K_2 & = S d^2S/dx^2 + dS/dx dS/dx \\
    & = Sd^2S/dx^2 + (dS/dx)^2 
\end{aligned}
$$

而根据
$
SdS/dx = - K_2 + (K_1 + K_2)x
$
化简可得$d^2S/dx^2$的符号取决于$(1 - \rho^2)\sigma_1^2\sigma_2^2$，即

$$
d^2S/dx^2 > 0.
$$

因此，在$(M, S)$空间内，可行转化边界函数为凸的。

## 均值-方差框架下的投资组合选择

![](pic/figure_9_1.png)

## 有一种无风险资产时的投资组合选择

![](pic/figure_9_2.png)

## 管理者的激励 I

假设企业所有者必须雇佣一个管理者来经营某项目：

- 如果项目成功的话，该项目将产生价值$V$

- 在高质量工作的情况下，项目成功的概率为$p$，在低质量工作的情况下，项目成功的概率为$q$

- 吸引一个管理者的基本薪水为$w$，为了实现高质量他必须更加努力，并且只有当他得到奖金$e$时他才会这么做

- 企业所有者和管理者都是风险中性的

## 管理者的激励 II

假定企业所有者可以观察到管理者的工作质量：

- 高质量工作期望利润：$pV - (w + e)$

- 低质量工作期望利润：$qV - w$

高质量工作利润必须满足：

- $(p - q)V > e$ （比较优势）

- $pV > w + e$ （正利润）

当无法观察努力时，差异性工作方案：

- 成功时支付$x$，失败时支付$y$。激励相容条件为：

$$
(p - q)(x - y) \geq e
$$

## 管理者的激励 III

参与约束：
$$
px + (1-p)y \geq w + e
$$

所有者利润最大化：
$$
\pi = pV - [px + (1-p)y]
$$

受约束于：
$$
\begin{aligned}
(p - q)(x - y) & \geq e \\
y + p(x - y) & \geq w + e
\end{aligned}
$$

## 管理者的激励 V

最优解特征：
$$
\begin{aligned}
x - y & = e/(p - q) \\
y & = w - eq/(p - q) \\
\pi & = pV - w - e
\end{aligned}
$$

## 成本加成合约 I

政府采购的特殊性：

- 信息不对称下的成本造假风险

- 需设计激励相容方案

关键约束条件：

- 个体理性约束 $R_i \geq c_i q_i$

- 激励相容约束 $\begin{cases}
R_1 - c_1 q_1 \geq R_2 - c_1 q_2 \\
R_2 - c_2 q_2 \geq R_1 - c_2 q_1
\end{cases}$