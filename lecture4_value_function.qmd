---
subtitle: "第四讲 最大值函数"
editor: visual
---

## 最大值函数

- 对于一个最优化问题，一般而言存在着选择变量、目标函数和约束条件。当选择变量达到**最优选择**$\bar{x}$ 时，目标函数取得最大值/最小值，即$v = F(\bar{x})$ 

- 在给定外生参数$\theta$，以及目标函数和约束条件形式的情况下，每个最优化问题对应着一个最大值$v$ ，以及一个（或若干个）最优选择$\bar{x}$

- 一旦考虑外生参数$\theta$ 的变化，选择变量所能达到的最优选择将会随之变化。即每种情况下的最优选择$\bar{x}$ 会是外生参数$\theta$ 的函数

- 对应的最大值/最小值实际上也会是外生参数$\theta$ 的函数$v(\theta)$

## 参数进入目标函数的情况

假定参数向量$\theta$ 进入目标函数，通过选择$x$ ，在向量约束$G(x) = c$ 下(注意：此时参数$\theta$ 并不会影响约束条件)最大化目标函数$F(x, \theta)$

此时，目标函数和拉格朗日函数均依赖于$\theta$，因此

$$L(x, \lambda, \theta) = F(x, \theta) + \lambda[c - G(x)]$$

最优选择$\bar{x}$ 满足一阶条件

$$L_{x}(\bar{x}, \lambda, \theta = 0), L_{\lambda} (\bar{x},\lambda, \theta) =0$$

## 最大值的变化

目标函数的最大值记作$v$，假定$\theta$ 变动到$\theta + d\theta$ 。这会导致最优选择$\bar{x}$ 变到$\bar{x} + d\bar{x}$，进而最大值$v$ 变到$d + dv$：

$$
\begin{aligned}
    dv
    & = F(\bar{x} + d\bar{x}, \theta + d\theta) - F(\bar{x}, \theta) \\
    & = F_{x}(\bar{x}, \theta) d\bar{x} + F_{\theta}(\bar{x}, \theta) d\theta \\
    & = \lambda G_{x}(\bar{x})d\bar{x} + F_{\theta}(\bar{x}, \theta) d\theta \\
    & = F_{\theta}(\bar{x}, \theta) d\theta
\end{aligned}
$$

- 当一个**不影响约束条件的参数**发生变化后，如果要计算其所导致目标函数最大值的一阶变化，不需要考虑最优选择$\bar{x}$ 自身的变动

- 我们可以考虑**在原来的最优选择处**计算参数$\theta$ 变动的偏导数，以及$\theta$ 的变动情况

## 成本最小化问题 I

最大化$F(x, \theta) = -\theta x$，同时满足$G(x) = c$

将由此产生的最大值记作$-v$ ，那么

$$
d(-v) = F_{\theta}(\bar{x}, \theta) d\theta = - d\theta \cdot \bar{x}\Longrightarrow dv = \bar{x}d\theta
$$

$v$ 意味着当投入要素价格为$\theta$ 时，生产出$c$ 单位产品的最小成本

当价格发生变化时，生产者会如何调整最优选择？

生产者会减少使用变得更贵的投入要素，同时用更多的（相对更便宜的）其他要素来替代，并且相互替代会沿着一条等产量线进行

## 成本最小化问题 II

我们对$v = \theta \bar{x}$ 进行微分，可得$dv = \theta d\bar{x} + d\theta\bar{x}$

- 第一项意味着，以原来的价格衡量的投入组合变动的价值

- 第二项意味着，以原来的最优产量衡量的价格变动的价值

- 在原来的价格下，原来的投入组合选择已经是最优的了，因此任何变动的价值的一阶效应必然为零

## 包络定理

![Caption](pic/figure_5_1.png){width=80%}

## 参数影响所有函数

假定参数$\theta$ 同时影响目标函数F和约束条件G，且约束条件为$G(x, \theta) = c$，其中$\theta$ 和$c$ 是不同的，因此
$$G_x(x, \theta) dx + G_{\theta} (x, \theta) d\theta = 0$$

对于最大值函数的变动而言

$$
\begin{aligned}
    dv & = -\lambda G_{\theta}(\bar{x}, \theta) d\theta + F_{\theta}(\bar{x}, \theta) d\theta \\
    & = L_{\theta}(\bar{x}, \lambda, \theta) d\theta
\end{aligned}
$$

比较条件5.1和5.4:

- 当$\theta$ 影响约束时，变动$d\theta$ 会影响约束条件$G(x)$，使得G的值增加$G_{\theta}(\bar{x}, \theta)d\theta$

- 这相当于$c$ 减少同等量，等价于$v$ 的值下降$\lambda G_{\theta}(\bar{x}, \theta) d\theta$ （注意:$\lambda$ 代表着$c$ 变化一单位导致最大值函数$v$ 的边际变化）

## 广义的参数向量 I

定义一个更大的参数向量$\hat{\theta}$ ，其包括子向量$\theta$ 和$c$ ，并将约束条件写作：

$$\hat{G} (x, \hat{\theta}) \equiv G(x, \theta) - c = 0$$

拉格朗日函数可以写作：

$$\hat{L}(x, \lambda, \hat{\theta}) \equiv F(x, \theta) - \lambda\hat{G}(x, \hat{\theta})$$

因此，最大值函数的变动等价于：

$$dv = \hat{L}_{\hat{\theta}}(\bar{x}, \lambda, \hat{\theta})d\hat{\theta}$$

## 广义的参数向量 II

而对于广义约束条件而言：

$$\hat{G}{\hat{\theta}}(x, \hat{\theta}) d\hat{\theta} = G_{\theta}(x, \theta) d\theta - dc$$

因而$dv$ 的表达式可以变为：

$$dv = L_{\theta} (\bar{x}, \lambda, \theta) d\theta + \lambda dc.$$

## 短期和长期的生产计划 I

对于一个厂商而言，长期内资本和劳动都可以调整，但在短期内资本固定在某个水平无法变动

假设选择变量是$y, z$ ，其中：

- 在长期中，$y$和$z$ 都可以任意变动

- 在短期内，$z$ 固定不变而仅有$y$ 可以变化

最优化问题可以写作：
$$
\begin{aligned}
    max  &\quad F(y, z, \theta) \\
    s.t. &\quad G(y,z,\theta) = 0
\end{aligned}
$$

## 短期和长期的生产计划 II

在长期中，最优选择和对应的值函数是外生参数$\theta$ 的函数，即

$$y_{l} = Y(\theta), z_{l} = Z(\theta), v_{l} = V(\theta)$$

在短期中，因为$z$固定不变，所以本质上是类似$\theta$ 的参数：

$$y_{s} = Y(z, \theta), v_{s} = V(z, \theta)$$

思考：$v_{l}$ 和$v_{s}$ 之间有什么关系呢？

## 最大值函数的关系

长期最大值和短期最大值之间：
$$
V(\theta)  \geq V(z, \theta), \forall (z,\theta)
$$

如果(短期)固定不变的$z$ 恰好是长期的最优选择$z_{l} = Z(\theta)$，那么上式取等号

如果上述函数都是可微的，那么我们可以得到

$$
V^{'}(\theta)= V_{\theta}(Z(\theta), \theta)
$$

## 短期和长期成本 I

考虑如下生产函数的短期和长期成本曲线之间的关系：
$$
Q = (KL)^{1/\alpha}
$$
其中，Q代表产量，K是短期固定资本，L是劳动。如果

- $\alpha = 2$，那么规模报酬不变

- $\alpha < 2$，那么规模报酬递增

- $\alpha > 2$，那么规模报酬递减

## 短期和长期成本 II

令$w$表示工资率，$r$表示资本使用成本。则长期成本函数为：
$$
C(w, r, Q) = min_{K,L}\{wL + rK |KL = Q^{\alpha}\}
$$
使用拉格朗日方法，很容易得到成本最小的投入选择：
$$
\begin{aligned}
    K & = (wQ^{\alpha}/r)^{1/2} \\
    L & = (rQ^{\alpha}/w)^{1/2}
\end{aligned}
$$
那么，长期成本函数为：
$$
C(w,r, Q) = 2(wr)^{1/2}Q^{\alpha/2}
$$

## 短期和长期成本 III

在短期内没有选择的自由。如果使用资本K生产出产量Q，那么必须使用劳动$L = Q^{\alpha}/K$，成本函数变为：
$$
C(w, r, Q, K)  = wQ^{\alpha}/K + rK
$$

- 长期的边际成本为：
$C_{Q}(w,r,Q)= \alpha(wr)^{1/2}Q^{\alpha/2 -1}$

- 短期的边际成本为：
$C_{Q}(w,r,Q,K) = \alpha wQ^{\alpha - 1}/K$

- 如果$K$的值恰好是式(5.1)给出的长期中$K$的最优值，那么短期边际成本和长期边际成本一致

## 消费者需求 I

- 考虑一个消费者，在$\textbf{p} \cdot \textbf{x} = I$的预算约束下最大化效用$U(x)$

- 这个最大化问题的参数为价格向量$\textbf{p}$和收入$I$，并由此得到最大效用为$V(\textbf{p}, I)$

- 称$V(\textbf{p}, I)$为**间接效用函数**，以区别于以消费商品数量决定的(直接)效用函数

## 消费者需求 II

对于上述效用最大化问题，其拉格朗日函数为：
$$
L(x, \lambda, p, I) = U(x) + \lambda(I - px)
$$

回忆一下，包络定理告诉我们，最大值的变动等价于
$$
dv = \hat{L}_{\hat{\theta}}(\bar{x}, \lambda, \hat{\theta})d\hat{\theta}
$$

因此，在最优解处必然有
$$
\begin{aligned}
    V_I(\textbf{p}, I) & = L_{I}(x, \lambda, p, I) = \lambda \\
    V_{p_i}(\textbf{p}, I) & = L_{p_i}(x, \lambda, p, I) = - \lambda x_i
\end{aligned}
$$

## 消费者需求 III

- 因此，如果我们知道消费者的间接效用函数，那么可以很轻易地找出消费者的需求函数：
$$
D(\textbf{p}, I) = - V_{p}(\textbf{p}, I)/V_I(\textbf{p}, I), \forall i = 1, \cdots, n
$$

- 相反，如果我们知道消费者的(直接)效用函数，那么需要求解所有约束条件下的最大化问题，才能找到消费者的需求函数

## 支出最小化问题

- 考虑消费者如何以最少的支出达到一个目标效用水平的问题，最小支出是关于价格向量$\textbf{p}$和目标效用水平$u$的函数$E(\textbf{p}, u)$，称之为**支出函数**

- 这个最小化问题的拉格朗日函数可以写作：
$$
L(x, \mu, p, u) = px + \mu[u - U(x)]
$$

- 类似地，$E_{u}(p, u) = \mu$，意味着为了实现目标效用水平的边际增加，所要求的最小支出的增加

- 以及，$E_{p}(p,u) =x$，代表着对给定效用水平时，使得支出最小的商品组合，我们称之为希克斯需求函数$C(p, u)$

## 斯拉茨基分解

- 从某个效用水平$u$开始，在给定价格水平下达到效用水平所需要的最小支出为$I = E(p,u)$，对应的希克斯需求为$C(p,u)$

- 以上面的最小支出$I$作为货币收入，并找到效用最大化的选择$D(p, I)$，则有$C(p, u) = D(p, I)$

- 对于第$j$个商品的需求，两边同时对第$k$个商品价格求导，根据链式法则有
$$
C^j_k(p, u) = D^j_k(p, E(p,u)) = D^j_k(p, I) + D^j_I(p, I)E_k(p,u)
$$